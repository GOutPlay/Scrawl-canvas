<!DOCTYPE html>

<html>
<head>
  <title>Demo Canvas 009</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" media="all" href="../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="canvas-001.html">
                  ./demo/canvas-001.js
                </a>
              
                
                <a class="source" href="canvas-002.html">
                  ./demo/canvas-002.js
                </a>
              
                
                <a class="source" href="canvas-003.html">
                  ./demo/canvas-003.js
                </a>
              
                
                <a class="source" href="canvas-004.html">
                  ./demo/canvas-004.js
                </a>
              
                
                <a class="source" href="canvas-005.html">
                  ./demo/canvas-005.js
                </a>
              
                
                <a class="source" href="canvas-006.html">
                  ./demo/canvas-006.js
                </a>
              
                
                <a class="source" href="canvas-007.html">
                  ./demo/canvas-007.js
                </a>
              
                
                <a class="source" href="canvas-008.html">
                  ./demo/canvas-008.js
                </a>
              
                
                <a class="source" href="canvas-009.html">
                  ./demo/canvas-009.js
                </a>
              
                
                <a class="source" href="canvas-010.html">
                  ./demo/canvas-010.js
                </a>
              
                
                <a class="source" href="canvas-011.html">
                  ./demo/canvas-011.js
                </a>
              
                
                <a class="source" href="canvas-012.html">
                  ./demo/canvas-012.js
                </a>
              
                
                <a class="source" href="canvas-013.html">
                  ./demo/canvas-013.js
                </a>
              
                
                <a class="source" href="canvas-014.html">
                  ./demo/canvas-014.js
                </a>
              
                
                <a class="source" href="canvas-015.html">
                  ./demo/canvas-015.js
                </a>
              
                
                <a class="source" href="canvas-016.html">
                  ./demo/canvas-016.js
                </a>
              
                
                <a class="source" href="canvas-017.html">
                  ./demo/canvas-017.js
                </a>
              
                
                <a class="source" href="canvas-018.html">
                  ./demo/canvas-018.js
                </a>
              
                
                <a class="source" href="canvas-019.html">
                  ./demo/canvas-019.js
                </a>
              
                
                <a class="source" href="canvas-020.html">
                  ./demo/canvas-020.js
                </a>
              
                
                <a class="source" href="canvas-021.html">
                  ./demo/canvas-021.js
                </a>
              
                
                <a class="source" href="canvas-022.html">
                  ./demo/canvas-022.js
                </a>
              
                
                <a class="source" href="canvas-023.html">
                  ./demo/canvas-023.js
                </a>
              
                
                <a class="source" href="canvas-024.html">
                  ./demo/canvas-024.js
                </a>
              
                
                <a class="source" href="canvas-025.html">
                  ./demo/canvas-025.js
                </a>
              
                
                <a class="source" href="canvas-026.html">
                  ./demo/canvas-026.js
                </a>
              
                
                <a class="source" href="canvas-027.html">
                  ./demo/canvas-027.js
                </a>
              
                
                <a class="source" href="canvas-028.html">
                  ./demo/canvas-028.js
                </a>
              
                
                <a class="source" href="canvas-029.html">
                  ./demo/canvas-029.js
                </a>
              
                
                <a class="source" href="canvas-030.html">
                  ./demo/canvas-030.js
                </a>
              
                
                <a class="source" href="canvas-031.html">
                  ./demo/canvas-031.js
                </a>
              
                
                <a class="source" href="canvas-032.html">
                  ./demo/canvas-032.js
                </a>
              
                
                <a class="source" href="canvas-033.html">
                  ./demo/canvas-033.js
                </a>
              
                
                <a class="source" href="canvas-034.html">
                  ./demo/canvas-034.js
                </a>
              
                
                <a class="source" href="canvas-035.html">
                  ./demo/canvas-035.js
                </a>
              
                
                <a class="source" href="canvas-036.html">
                  ./demo/canvas-036.js
                </a>
              
                
                <a class="source" href="canvas-037.html">
                  ./demo/canvas-037.js
                </a>
              
                
                <a class="source" href="canvas-038.html">
                  ./demo/canvas-038.js
                </a>
              
                
                <a class="source" href="component-001.html">
                  ./demo/component-001.js
                </a>
              
                
                <a class="source" href="component-002.html">
                  ./demo/component-002.js
                </a>
              
                
                <a class="source" href="component-003.html">
                  ./demo/component-003.js
                </a>
              
                
                <a class="source" href="component-004.html">
                  ./demo/component-004.js
                </a>
              
                
                <a class="source" href="component-005.html">
                  ./demo/component-005.js
                </a>
              
                
                <a class="source" href="core-001.html">
                  ./demo/core-001.js
                </a>
              
                
                <a class="source" href="dom-001.html">
                  ./demo/dom-001.js
                </a>
              
                
                <a class="source" href="dom-002.html">
                  ./demo/dom-002.js
                </a>
              
                
                <a class="source" href="dom-003.html">
                  ./demo/dom-003.js
                </a>
              
                
                <a class="source" href="dom-004.html">
                  ./demo/dom-004.js
                </a>
              
                
                <a class="source" href="dom-005.html">
                  ./demo/dom-005.js
                </a>
              
                
                <a class="source" href="dom-006.html">
                  ./demo/dom-006.js
                </a>
              
                
                <a class="source" href="dom-007.html">
                  ./demo/dom-007.js
                </a>
              
                
                <a class="source" href="dom-008.html">
                  ./demo/dom-008.js
                </a>
              
                
                <a class="source" href="dom-009.html">
                  ./demo/dom-009.js
                </a>
              
                
                <a class="source" href="dom-010.html">
                  ./demo/dom-010.js
                </a>
              
                
                <a class="source" href="dom-011.html">
                  ./demo/dom-011.js
                </a>
              
                
                <a class="source" href="dom-012.html">
                  ./demo/dom-012.js
                </a>
              
                
                <a class="source" href="dom-013.html">
                  ./demo/dom-013.js
                </a>
              
                
                <a class="source" href="dom-014a.html">
                  ./demo/dom-014a.js
                </a>
              
                
                <a class="source" href="dom-014b.html">
                  ./demo/dom-014b.js
                </a>
              
                
                <a class="source" href="dom-014c.html">
                  ./demo/dom-014c.js
                </a>
              
                
                <a class="source" href="dom-015.html">
                  ./demo/dom-015.js
                </a>
              
                
                <a class="source" href="dom-016.html">
                  ./demo/dom-016.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h1 id="demo-canvas-009">Demo Canvas 009</h1>
<p>Pattern styles; Entity web link anchors; Dynamic accessibility</p>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p><a href="../../demo/canvas-009.html">Run code</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">import</span> scrawl <span class="hljs-keyword">from</span> <span class="hljs-string">'../source/scrawl.js'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h4 id="google-analytics">Google Analytics</h4>
<p>We load GA code in the normal way through markup in the dom-006.html file (lines 11-21), and get a handle on the <strong>ga</strong> object here</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> ga = <span class="hljs-built_in">window</span>[<span class="hljs-built_in">window</span>[<span class="hljs-string">'GoogleAnalyticsObject'</span>] || <span class="hljs-string">'ga'</span>],
    myTracker;</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Create a new tracker to handle tween and ticker action/progress, and set some attributes on it. </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>ga(<span class="hljs-string">'create'</span>, <span class="hljs-string">'UA-000000-0'</span>, <span class="hljs-string">'auto'</span>, <span class="hljs-string">'demoCanvasTracker'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>We can then incorporate the tracker’s functionality in our various hook functions defined further down in this script</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>ga(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">let</span> ga = <span class="hljs-built_in">window</span>[<span class="hljs-built_in">window</span>[<span class="hljs-string">'GoogleAnalyticsObject'</span>] || <span class="hljs-string">'ga'</span>];

    myTracker = ga.getByName(<span class="hljs-string">'demoCanvasTracker'</span>);
    myTracker.set(<span class="hljs-string">'transport'</span>, <span class="hljs-string">'beacon'</span>);
    myTracker.set(<span class="hljs-string">'campaignKeyword'</span>, <span class="hljs-string">'Scrawl-canvas demo'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Comment out the next line to send tracker packets (so they show up in the console)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    myTracker.set(<span class="hljs-string">'sendHitTask'</span>, <span class="hljs-literal">null</span>);
});</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h4 id="scene-setup">Scene setup</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> canvas = scrawl.library.artefact.mycanvas;</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Get images from DOM</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.importDomImage(<span class="hljs-string">'.mypatterns'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Create Pattern styles using imported images</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.makePattern({

    <span class="hljs-attr">name</span>: <span class="hljs-string">'brick-pattern'</span>,
    <span class="hljs-attr">asset</span>: <span class="hljs-string">'brick'</span>,

}).clone({

    <span class="hljs-attr">name</span>: <span class="hljs-string">'leaves-pattern'</span>,
    <span class="hljs-attr">asset</span>: <span class="hljs-string">'leaves'</span>,

});</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Create Pattern styles dynamically</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.makePattern({

    <span class="hljs-attr">name</span>: <span class="hljs-string">'water-pattern'</span>,
    <span class="hljs-attr">imageSource</span>: <span class="hljs-string">'img/water.png'</span>,

}).clone({

    <span class="hljs-attr">name</span>: <span class="hljs-string">'marble-pattern'</span>,
    <span class="hljs-attr">imageSource</span>: <span class="hljs-string">'img/marble.png'</span>,

});</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Create a canvas-based Cell pattern</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>canvas.buildCell({

    <span class="hljs-attr">name</span>: <span class="hljs-string">'cell-pattern'</span>,

    <span class="hljs-attr">width</span>: <span class="hljs-number">50</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-number">50</span>,

    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">'lightblue'</span>,

    <span class="hljs-attr">shown</span>: <span class="hljs-literal">false</span>,
});

canvas.base.set({

    <span class="hljs-attr">compileOrder</span>: <span class="hljs-number">1</span>,
});</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Create a Block entity to display in the new Cell pattern</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.makeBlock({

    <span class="hljs-attr">name</span>: <span class="hljs-string">'cell-pattern-block'</span>,
    <span class="hljs-attr">group</span>: <span class="hljs-string">'cell-pattern'</span>,

    <span class="hljs-attr">width</span>: <span class="hljs-number">40</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-number">40</span>,

    <span class="hljs-attr">startX</span>: <span class="hljs-string">'center'</span>,
    <span class="hljs-attr">startY</span>: <span class="hljs-string">'center'</span>,

    <span class="hljs-attr">handleX</span>: <span class="hljs-string">'center'</span>,
    <span class="hljs-attr">handleY</span>: <span class="hljs-string">'center'</span>,

    <span class="hljs-attr">method</span>: <span class="hljs-string">'fill'</span>,

    <span class="hljs-attr">fillStyle</span>: <span class="hljs-string">'water-pattern'</span>,

    <span class="hljs-attr">delta</span>: {
        <span class="hljs-attr">roll</span>: <span class="hljs-number">-0.3</span>
    },
});</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Main canvas display - create Block entitys which will use the patterns defined above</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.makeBlock({

    <span class="hljs-attr">name</span>: <span class="hljs-string">'water-in-leaves'</span>,
    <span class="hljs-attr">group</span>: canvas.base.name,

    <span class="hljs-attr">width</span>: <span class="hljs-string">'40%'</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-string">'40%'</span>,

    <span class="hljs-attr">startX</span>: <span class="hljs-string">'25%'</span>,
    <span class="hljs-attr">startY</span>: <span class="hljs-string">'25%'</span>,

    <span class="hljs-attr">handleX</span>: <span class="hljs-string">'center'</span>,
    <span class="hljs-attr">handleY</span>: <span class="hljs-string">'center'</span>,

    <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">20</span>,
    <span class="hljs-attr">lineJoin</span>: <span class="hljs-string">'round'</span>,

    <span class="hljs-attr">method</span>: <span class="hljs-string">'fillThenDraw'</span>,

    <span class="hljs-attr">fillStyle</span>: <span class="hljs-string">'cell-pattern'</span>,
    <span class="hljs-attr">strokeStyle</span>: <span class="hljs-string">'leaves-pattern'</span>,

    <span class="hljs-attr">shadowOffsetX</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">shadowOffsetY</span>: <span class="hljs-number">5</span>,
    <span class="hljs-attr">shadowBlur</span>: <span class="hljs-number">3</span>,
    <span class="hljs-attr">shadowColor</span>: <span class="hljs-string">'black'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Include an anchor (href) link which can be tied to user interaction (in this case, mouse clicks on the canvas element) through events defined further down in this script.</p>

            </div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>ALWAYS include a description! We will be using the anchor’s description string later as part of our asistive technology solution for this demo.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    anchor: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'wikipedia-water-link'</span>,
        <span class="hljs-attr">href</span>: <span class="hljs-string">'https://en.wikipedia.org/wiki/Water'</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">'Link to the Wikipedia article on water (opens in new tab)'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>The clickAction attribute captures both Scrawl-canvas trigger clicks and also non-mouse ‘clicks’ on the anchor element hidden at the top of the web page, for example using the keyboard (tab, return) or other assistive technology.</p>

            </div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>The function returns a string which Scrawl-canvas will add to the anchor’s ‘onclick’ attribute when it creates the anchor element dynamically and adds it to the DOM.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        clickAction: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

            <span class="hljs-keyword">return</span> <span class="hljs-string">`ga('demoCanvasTracker.send', 'event', 'Outbound link', 'click', '<span class="hljs-subst">${<span class="hljs-keyword">this</span>.href}</span>')`</span>;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Include focus and blur actions, which will trigger the onEnter and onLeave functions (below) for visitors using non-mouse/touch navigation (for example: keyboard tabbing)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        focusAction: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">blurAction</span>: <span class="hljs-literal">true</span>,
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Accessibility functionality to be used by event functions defined below in response to user activity - this time moving the mouse cursor across the &lt;canvas&gt; element. Note that ‘this’ refers to the entity object, meaning the functions can be safely cloned into other entitys.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    onEnter: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Update the block entity’s visual display</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.set({
            <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">30</span>,
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>This is where we update the accessibility information tied to the canvas element. We’re using the anchor attribute object’s description value to supply details of what actions will happen when the user clicks on the canvas while the mouse is over the block entity.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        canvas.set({
            <span class="hljs-attr">title</span>: <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> tile`</span>,
            <span class="hljs-attr">label</span>: <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'anchorDescription'</span>),
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Track the action in Google Analytics</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        myTracker.send(<span class="hljs-string">'event'</span>, <span class="hljs-string">'Canvas Entity'</span>, <span class="hljs-string">'hover start'</span>, <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> <span class="hljs-subst">${<span class="hljs-keyword">this</span>.type}</span>`</span>);
    },

    <span class="hljs-attr">onLeave</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Reset the block entity’s visual display</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.set({
            <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">20</span>,
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Reset the accessibility information tied to the canvas element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        canvas.set({
            <span class="hljs-attr">title</span>: <span class="hljs-string">''</span>,
            <span class="hljs-attr">label</span>: <span class="hljs-string">`<span class="hljs-subst">${canvas.name}</span> canvas element`</span>,
        });</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Track the action in Google Analytics</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        myTracker.send(<span class="hljs-string">'event'</span>, <span class="hljs-string">'Canvas Entity'</span>, <span class="hljs-string">'hover end'</span>, <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> <span class="hljs-subst">${<span class="hljs-keyword">this</span>.type}</span>`</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Used by the Scrawl-canvas click event, below. This hit report will only be generated from user interaction on the canvas element, thus will supply different numbers to the anchor’s clickAction function above - a useful way to help calculate the volume of users bypassing the canvas and opening the Wikipedia page using the keyboard or assistive technology</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    onUp: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Track the action in Google Analytics</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        myTracker.send(<span class="hljs-string">'event'</span>, <span class="hljs-string">'Canvas Entity Link'</span>, <span class="hljs-string">'click'</span>, <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> <span class="hljs-subst">${<span class="hljs-keyword">this</span>.type}</span> <span class="hljs-subst">${<span class="hljs-keyword">this</span>.anchor.href}</span>`</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Trigger the click event on the anchor element we added to the DOM</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>.clickAnchor();
    },

}).clone({

    <span class="hljs-attr">name</span>: <span class="hljs-string">'leaves-in-brick'</span>,

    <span class="hljs-attr">startX</span>: <span class="hljs-string">'75%'</span>,

    <span class="hljs-attr">fillStyle</span>: <span class="hljs-string">'leaves-pattern'</span>,
    <span class="hljs-attr">strokeStyle</span>: <span class="hljs-string">'brick-pattern'</span>,

    <span class="hljs-attr">anchor</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'wikipedia-leaf-link'</span>,
        <span class="hljs-attr">href</span>: <span class="hljs-string">'https://en.wikipedia.org/wiki/Leaf'</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">'Link to the Wikipedia article on leaves (opens in new tab)'</span>,
    },

}).clone({
    
    <span class="hljs-attr">name</span>: <span class="hljs-string">'brick-in-marble'</span>,

    <span class="hljs-attr">startY</span>: <span class="hljs-string">'75%'</span>,

    <span class="hljs-attr">fillStyle</span>: <span class="hljs-string">'brick-pattern'</span>,
    <span class="hljs-attr">strokeStyle</span>: <span class="hljs-string">'marble-pattern'</span>,

    <span class="hljs-attr">anchor</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'wikipedia-brick-link'</span>,
        <span class="hljs-attr">href</span>: <span class="hljs-string">'https://en.wikipedia.org/wiki/Brick'</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">'Link to the Wikipedia article on bricks (opens in new tab)'</span>,
    },

}).clone({
    
    <span class="hljs-attr">name</span>: <span class="hljs-string">'marble-in-water'</span>,

    <span class="hljs-attr">startX</span>: <span class="hljs-string">'25%'</span>,

    <span class="hljs-attr">fillStyle</span>: <span class="hljs-string">'marble-pattern'</span>,
    <span class="hljs-attr">strokeStyle</span>: <span class="hljs-string">'water-pattern'</span>,

    <span class="hljs-attr">anchor</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'wikipedia-marble-link'</span>,
        <span class="hljs-attr">href</span>: <span class="hljs-string">'https://en.wikipedia.org/wiki/Marble'</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">'Link to the Wikipedia article on marble (opens in new tab)'</span>,
    },
});</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Demonstrate zoned actions on a canvas element as a result of user interaction</p>
<ul>
<li>Available cascadeEventAction arguments are: ‘enter’, ‘leave’, ‘down’, or ‘up’</li>
<li>Also, the ‘move’ argument will trigger enter and leave actions on the entitys, as appropriate to each</li>
</ul>
<p>In this case, moving the mouse cursor over a block entity will increase its line width, as specified in the <strong>onEnter</strong> and <strong>onLeave</strong> functions in the block factories above. </p>
<p>Additionally, it will update the &lt;canvas&gt; element’s title attribute (for tool tips) and its ARIA label value (for accessibility)</p>
<p>The cascadeEventAction function returns an Array of name Strings for the entitys at the current mouse cursor coordinates </p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> interactionResults = <span class="hljs-string">''</span>;
<span class="hljs-keyword">let</span> interactions = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">if</span> (canvas.here.active) interactionResults = canvas.cascadeEventAction(<span class="hljs-string">'move'</span>);
    <span class="hljs-keyword">else</span> interactionResults = <span class="hljs-string">''</span>;
};
scrawl.addListener(<span class="hljs-string">'move'</span>, interactions, canvas.domElement);</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>To capture other user interaction with the &lt;a&gt; DOM elements which, while being visually hidden, are still accessible - for instance when a user keyboard-tabs through the web page</p>
<p>In this case, clicking on one of the tiles will open a related Wikipedia page in a new browser tab - as defined in the  <strong>onUp</strong> function in the block factories above</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> mylinks = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">if</span> (canvas.here.active) canvas.cascadeEventAction(<span class="hljs-string">'up'</span>);
};
scrawl.addListener(<span class="hljs-string">'up'</span>, mylinks, canvas.domElement);</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <h4 id="scene-animation">Scene animation</h4>
<p>Function to display frames-per-second data, and other information relevant to the demo</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> report = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">let</span> testTicker = <span class="hljs-built_in">Date</span>.now(),
        testTime, testNow,
        testMessage = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#reportmessage'</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

        testNow = <span class="hljs-built_in">Date</span>.now();
        testTime = testNow - testTicker;
        testTicker = testNow;

        testMessage.textContent = <span class="hljs-string">`Screen refresh: <span class="hljs-subst">${<span class="hljs-built_in">Math</span>.ceil(testTime)}</span>ms; fps: <span class="hljs-subst">${<span class="hljs-built_in">Math</span>.floor(<span class="hljs-number">1000</span> / testTime)}</span>
Hits: <span class="hljs-subst">${interactionResults}</span>`</span>;
    };
}();</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Create the Display cycle animation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.makeRender({

    <span class="hljs-attr">name</span>: <span class="hljs-string">'demo-animation'</span>,
    <span class="hljs-attr">target</span>: canvas,
    <span class="hljs-attr">afterShow</span>: report,
});</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <h4 id="development-and-testing">Development and testing</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">console</span>.log(scrawl.library);</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>To test artefact kill functionality</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> killArtefact = <span class="hljs-function">(<span class="hljs-params">name, anchorname, time, finishResurrection</span>) =&gt;</span> {

    <span class="hljs-keyword">let</span> groupname = <span class="hljs-string">'mycanvas_base'</span>,
        packet;

    <span class="hljs-keyword">let</span> checkGroupBucket = <span class="hljs-function">(<span class="hljs-params">name, groupname</span>) =&gt;</span> {

        <span class="hljs-keyword">let</span> res = scrawl.library.group[groupname].artefactBuckets.filter(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> e.name === name );
        <span class="hljs-keyword">return</span> (res.length) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>;
    };

    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {

        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${name}</span> alive
    removed from artefact: <span class="hljs-subst">${(scrawl.library.artefact[name]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from artefactnames: <span class="hljs-subst">${(scrawl.library.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from entity: <span class="hljs-subst">${(scrawl.library.entity[name]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from entitynames: <span class="hljs-subst">${(scrawl.library.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from group.artefacts: <span class="hljs-subst">${(scrawl.library.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from group.artefactBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>
    anchor removed: <span class="hljs-subst">${(scrawl.library.anchor[anchorname]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>`</span>);

        packet = scrawl.library.artefact[name].saveAsPacket();

        scrawl.library.artefact[name].kill();

        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {

            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${name}</span> killed
    removed from artefact: <span class="hljs-subst">${(scrawl.library.artefact[name]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from artefactnames: <span class="hljs-subst">${(scrawl.library.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from entity: <span class="hljs-subst">${(scrawl.library.entity[name]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from entitynames: <span class="hljs-subst">${(scrawl.library.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from group.artefacts: <span class="hljs-subst">${(scrawl.library.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from group.artefactBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>
    anchor removed: <span class="hljs-subst">${(scrawl.library.anchor[anchorname]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>`</span>);

            canvas.actionPacket(packet);

            setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {

                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${name}</span> resurrected
    removed from artefact: <span class="hljs-subst">${(scrawl.library.artefact[name]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from artefactnames: <span class="hljs-subst">${(scrawl.library.artefactnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from entity: <span class="hljs-subst">${(scrawl.library.entity[name]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from entitynames: <span class="hljs-subst">${(scrawl.library.entitynames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from group.artefacts: <span class="hljs-subst">${(scrawl.library.group[groupname].artefacts.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from group.artefactBuckets: <span class="hljs-subst">${checkGroupBucket(name, groupname)}</span>
    anchor removed: <span class="hljs-subst">${(scrawl.library.anchor[anchorname]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>`</span>);

                finishResurrection();

            }, <span class="hljs-number">100</span>);
        }, <span class="hljs-number">100</span>);
    }, time);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>We use the <strong>canvas</strong> and <strong>myTracker</strong> variables in our blocks’ onEnter, onLeave and onUp functions. While this works fine for the blocks created in the scope of this module file’s code, it will fail when we kill and resurrect a block - in the resurrected block the canvas and myTracker variables will be ‘undefined’. So we need to reset the block’s ‘on…’ functions (in this module file’s code) after the block has resurrected</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>killArtefact(<span class="hljs-string">'brick-in-marble'</span>, <span class="hljs-string">'wikipedia-brick-link'</span>, <span class="hljs-number">2000</span>, () =&gt; {

    scrawl.library.artefact[<span class="hljs-string">'brick-in-marble'</span>].set({

        <span class="hljs-attr">onEnter</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.set({ <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">30</span> });
            canvas.set({
                <span class="hljs-attr">title</span>: <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> tile`</span>,
                <span class="hljs-attr">label</span>: <span class="hljs-keyword">this</span>.get(<span class="hljs-string">'anchorDescription'</span>),
            });
            myTracker.send(<span class="hljs-string">'event'</span>, <span class="hljs-string">'Canvas Entity'</span>, <span class="hljs-string">'hover start'</span>, <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> <span class="hljs-subst">${<span class="hljs-keyword">this</span>.type}</span>`</span>);
        },
        <span class="hljs-attr">onLeave</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">this</span>.set({ <span class="hljs-attr">lineWidth</span>: <span class="hljs-number">20</span> });
            canvas.set({
                <span class="hljs-attr">title</span>: <span class="hljs-string">''</span>,
                <span class="hljs-attr">label</span>: <span class="hljs-string">`<span class="hljs-subst">${canvas.name}</span> canvas element`</span>,
            });
            myTracker.send(<span class="hljs-string">'event'</span>, <span class="hljs-string">'Canvas Entity'</span>, <span class="hljs-string">'hover end'</span>, <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> <span class="hljs-subst">${<span class="hljs-keyword">this</span>.type}</span>`</span>);
        },
        <span class="hljs-attr">onUp</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            myTracker.send(<span class="hljs-string">'event'</span>, <span class="hljs-string">'Canvas Entity Link'</span>, <span class="hljs-string">'click'</span>, <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> <span class="hljs-subst">${<span class="hljs-keyword">this</span>.type}</span> <span class="hljs-subst">${<span class="hljs-keyword">this</span>.anchor.href}</span>`</span>);
            <span class="hljs-keyword">this</span>.clickAnchor();
        },
    });
});</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>To test styles (Pattern) kill functionality</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> killStyle = <span class="hljs-function">(<span class="hljs-params">name, time, finishResurrection</span>) =&gt;</span> {

    <span class="hljs-keyword">let</span> packet;

    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {

        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${name}</span> alive
    removed from styles: <span class="hljs-subst">${(scrawl.library.styles[name]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from stylesnames: <span class="hljs-subst">${(scrawl.library.stylesnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>`</span>);

        packet = scrawl.library.styles[name].saveAsPacket();

        <span class="hljs-built_in">console</span>.log(packet);

        scrawl.library.styles[name].kill();

        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {

            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${name}</span> killed
    removed from styles: <span class="hljs-subst">${(scrawl.library.styles[name]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from stylesnames: <span class="hljs-subst">${(scrawl.library.stylesnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>`</span>);

            canvas.actionPacket(packet);

            setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {

                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${name}</span> resurrected
    removed from styles: <span class="hljs-subst">${(scrawl.library.styles[name]) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>
    removed from stylesnames: <span class="hljs-subst">${(scrawl.library.stylesnames.indexOf(name) &gt;= <span class="hljs-number">0</span>) ? <span class="hljs-string">'no'</span> : <span class="hljs-string">'yes'</span>}</span>`</span>);

                finishResurrection();

            }, <span class="hljs-number">100</span>);
        }, <span class="hljs-number">100</span>);
    }, time);
};

killStyle(<span class="hljs-string">'marble-pattern'</span>, <span class="hljs-number">3000</span>, () =&gt; {</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Reset entitys, whose fill/strokeStyles will have been set to default values when the Pattern died</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    scrawl.library.entity[<span class="hljs-string">'brick-in-marble'</span>].set({
        <span class="hljs-attr">strokeStyle</span>: <span class="hljs-string">'marble-pattern'</span>,
    });

    scrawl.library.entity[<span class="hljs-string">'marble-in-water'</span>].set({
        <span class="hljs-attr">fillStyle</span>: <span class="hljs-string">'marble-pattern'</span>,
    });
});</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
