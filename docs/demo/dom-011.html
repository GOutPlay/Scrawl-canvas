<!DOCTYPE html>

<html>
<head>
  <title>dom-011.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="canvas-001.html">
                  ./demo/canvas-001.js
                </a>
              
                
                <a class="source" href="canvas-002.html">
                  ./demo/canvas-002.js
                </a>
              
                
                <a class="source" href="canvas-003.html">
                  ./demo/canvas-003.js
                </a>
              
                
                <a class="source" href="canvas-004.html">
                  ./demo/canvas-004.js
                </a>
              
                
                <a class="source" href="canvas-005.html">
                  ./demo/canvas-005.js
                </a>
              
                
                <a class="source" href="canvas-006.html">
                  ./demo/canvas-006.js
                </a>
              
                
                <a class="source" href="canvas-007.html">
                  ./demo/canvas-007.js
                </a>
              
                
                <a class="source" href="canvas-008.html">
                  ./demo/canvas-008.js
                </a>
              
                
                <a class="source" href="canvas-009.html">
                  ./demo/canvas-009.js
                </a>
              
                
                <a class="source" href="canvas-010.html">
                  ./demo/canvas-010.js
                </a>
              
                
                <a class="source" href="canvas-011.html">
                  ./demo/canvas-011.js
                </a>
              
                
                <a class="source" href="canvas-012.html">
                  ./demo/canvas-012.js
                </a>
              
                
                <a class="source" href="canvas-013.html">
                  ./demo/canvas-013.js
                </a>
              
                
                <a class="source" href="canvas-014.html">
                  ./demo/canvas-014.js
                </a>
              
                
                <a class="source" href="canvas-015.html">
                  ./demo/canvas-015.js
                </a>
              
                
                <a class="source" href="canvas-016.html">
                  ./demo/canvas-016.js
                </a>
              
                
                <a class="source" href="canvas-017.html">
                  ./demo/canvas-017.js
                </a>
              
                
                <a class="source" href="canvas-018.html">
                  ./demo/canvas-018.js
                </a>
              
                
                <a class="source" href="canvas-019.html">
                  ./demo/canvas-019.js
                </a>
              
                
                <a class="source" href="canvas-020.html">
                  ./demo/canvas-020.js
                </a>
              
                
                <a class="source" href="canvas-021.html">
                  ./demo/canvas-021.js
                </a>
              
                
                <a class="source" href="canvas-022.html">
                  ./demo/canvas-022.js
                </a>
              
                
                <a class="source" href="canvas-023.html">
                  ./demo/canvas-023.js
                </a>
              
                
                <a class="source" href="canvas-024.html">
                  ./demo/canvas-024.js
                </a>
              
                
                <a class="source" href="component-001.html">
                  ./demo/component-001.js
                </a>
              
                
                <a class="source" href="component-002.html">
                  ./demo/component-002.js
                </a>
              
                
                <a class="source" href="component-003.html">
                  ./demo/component-003.js
                </a>
              
                
                <a class="source" href="component-004.html">
                  ./demo/component-004.js
                </a>
              
                
                <a class="source" href="core-001.html">
                  ./demo/core-001.js
                </a>
              
                
                <a class="source" href="dom-001.html">
                  ./demo/dom-001.js
                </a>
              
                
                <a class="source" href="dom-002.html">
                  ./demo/dom-002.js
                </a>
              
                
                <a class="source" href="dom-003.html">
                  ./demo/dom-003.js
                </a>
              
                
                <a class="source" href="dom-004.html">
                  ./demo/dom-004.js
                </a>
              
                
                <a class="source" href="dom-005.html">
                  ./demo/dom-005.js
                </a>
              
                
                <a class="source" href="dom-006.html">
                  ./demo/dom-006.js
                </a>
              
                
                <a class="source" href="dom-007.html">
                  ./demo/dom-007.js
                </a>
              
                
                <a class="source" href="dom-008.html">
                  ./demo/dom-008.js
                </a>
              
                
                <a class="source" href="dom-009.html">
                  ./demo/dom-009.js
                </a>
              
                
                <a class="source" href="dom-010.html">
                  ./demo/dom-010.js
                </a>
              
                
                <a class="source" href="dom-011.html">
                  ./demo/dom-011.js
                </a>
              
                
                <a class="source" href="dom-012.html">
                  ./demo/dom-012.js
                </a>
              
                
                <a class="source" href="dom-013.html">
                  ./demo/dom-013.js
                </a>
              
                
                <a class="source" href="dom-014a.html">
                  ./demo/dom-014a.js
                </a>
              
                
                <a class="source" href="dom-014b.html">
                  ./demo/dom-014b.js
                </a>
              
                
                <a class="source" href="dom-014c.html">
                  ./demo/dom-014c.js
                </a>
              
                
                <a class="source" href="dom-015.html">
                  ./demo/dom-015.js
                </a>
              
                
                <a class="source" href="../min/scrawl.html">
                  ./min/scrawl.js
                </a>
              
                
                <a class="source" href="../source/scrawl.html">
                  ./source/scrawl.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>dom-011.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <h2 id="demo-dom-011">Demo DOM 011</h2>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p><a href="../../demo/dom-011.html">Canvas controller ‘fit’ attribute; Cell positioning (mouse)</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">import</span> scrawl <span class="hljs-keyword">from</span> <span class="hljs-string">'../source/scrawl.js'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Scene setup</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> artefact = scrawl.library.artefact,
    stack = artefact.mystack,
    canvas = artefact.mycanvas;</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Resize the stack, and give it some CSS</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>stack.set({
    <span class="hljs-attr">width</span>: <span class="hljs-number">400</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-number">400</span>,
    <span class="hljs-attr">css</span>: {
        <span class="hljs-attr">margin</span>: <span class="hljs-string">'15px 0 0 0'</span>,
        <span class="hljs-attr">border</span>: <span class="hljs-string">'1px solid black'</span>,
        <span class="hljs-attr">overflow</span>: <span class="hljs-string">'hidden'</span>,
        <span class="hljs-attr">resize</span>: <span class="hljs-string">'both'</span>,
    },
    <span class="hljs-attr">actionResize</span>: <span class="hljs-literal">true</span>,
});</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Setup the (displayed) canvas element to cover the entire stack element, and to respond to changes in the Stack’s dimensions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>canvas.set({
    <span class="hljs-attr">width</span>: <span class="hljs-string">'100%'</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-string">'100%'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>The ‘fit’ attribute comes into play when the displayed canvas element and its hidden canvas companion (the base canvas) have different dimensions. The hidden canvas is copied over to the displayed canvas at the end of every display cycle.</p>

            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>We can influence how this copy happens by setting the ‘fit’ attribute to an appropriate String value (‘fill’, ‘contain’, ‘cover’, or ‘none’). These replicate the effect of the CSS object-fit property (see <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit">https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit</a>)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    fit: <span class="hljs-string">'fill'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>We’ve given the Stack element a 1px border. We need to compensate for this (and any top/left padding) when aligning the canvas element within the stack. if we don’t do this, we get a 1px white line between the stack border and the canvas (on the top and left edges)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    startX: <span class="hljs-number">-1</span>,
    <span class="hljs-attr">startY</span>: <span class="hljs-number">-1</span>,
});</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>The base canvas - every displayed canvas element has at least one hidden (‘base’) canvas companion - does not need to replicate the displayed canvas. For instance, it can have different dimensions. The base canvas is copied over to the displayed canvas at the end of every display cycle.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>canvas.setBase({
    <span class="hljs-attr">width</span>: <span class="hljs-number">800</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-number">600</span>,
    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">'lightblue'</span>,
});</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>A displayed canvas can have more than one hidden canvas. These additional ‘cells’ - which act much like traditional animation cels (see <a href="https://en.wikipedia.org/wiki/Cel">https://en.wikipedia.org/wiki/Cel</a>) - will be copied onto the ‘base’ canvas before the it gets copied over to the displayed cell at the end of every display cycle.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> cell = canvas.buildCell({
    <span class="hljs-attr">name</span>: <span class="hljs-string">'mycell'</span>,
    <span class="hljs-attr">width</span>: <span class="hljs-string">'50%'</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-string">'50%'</span>,
    <span class="hljs-attr">startX</span>: <span class="hljs-string">'center'</span>,
    <span class="hljs-attr">startY</span>: <span class="hljs-string">'center'</span>,
    <span class="hljs-attr">handleX</span>: <span class="hljs-string">'center'</span>,
    <span class="hljs-attr">handleY</span>: <span class="hljs-string">'center'</span>,
    <span class="hljs-attr">roll</span>: <span class="hljs-number">12</span>,
    <span class="hljs-attr">scale</span>: <span class="hljs-number">1.2</span>,
    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">'blue'</span>,
});</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Function to check whether mouse cursor is over the canvas element within the stack, and lock the element artefact accordingly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>let check = function () {

    let active = false,
        here = canvas.here,
        cell = scrawl.library.asset.mycell;

    return function () {

        if (here.baseActive !== active) {

            active = here.baseActive;

            cell.set({
                lockTo: (active) ? 'mouse' : 'start',
            });
        }
    };
}();


let report = function () {

    let testTicker = Date.now(),
        testTime, testNow, text,
        testMessage = document.querySelector('#reportmessage');

    return function () {

        testNow = Date.now();
        testTime = testNow - testTicker;
        testTicker = testNow;

        testMessage.textContent = `Screen refresh: ${Math.ceil(testTime)}ms; fps: ${Math.floor(1000 / testTime)}`;
    };
}();</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Create the Animation loop which will run the Display cycle. Note that we don’t have to define a target - useful for when we want to cascade through multiple stacks (which don’t themselves trigger canvas redraws, just canvas positioning) and multiple canvases</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.makeRender({

    <span class="hljs-attr">name</span>: <span class="hljs-string">'demo-animation'</span>,
    <span class="hljs-attr">commence</span>: check,
    <span class="hljs-attr">afterShow</span>: report,
});</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Event listeners</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>scrawl.observeAndUpdate({

    <span class="hljs-attr">event</span>: [<span class="hljs-string">'input'</span>, <span class="hljs-string">'change'</span>],
    <span class="hljs-attr">origin</span>: <span class="hljs-string">'.controlItem'</span>,

    <span class="hljs-attr">target</span>: canvas,

    <span class="hljs-attr">useNativeListener</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">preventDefault</span>: <span class="hljs-literal">true</span>,

    <span class="hljs-attr">updates</span>: {
        <span class="hljs-attr">fitselect</span>: [<span class="hljs-string">'fit'</span>, <span class="hljs-string">'raw'</span>],
    },
});

scrawl.observeAndUpdate({

    <span class="hljs-attr">event</span>: [<span class="hljs-string">'input'</span>, <span class="hljs-string">'change'</span>],
    <span class="hljs-attr">origin</span>: <span class="hljs-string">'.controlItem'</span>,

    <span class="hljs-attr">target</span>: stack,

    <span class="hljs-attr">useNativeListener</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">preventDefault</span>: <span class="hljs-literal">true</span>,

    <span class="hljs-attr">updates</span>: {
        <span class="hljs-attr">width</span>: [<span class="hljs-string">'width'</span>, <span class="hljs-string">'round'</span>],
        <span class="hljs-attr">height</span>: [<span class="hljs-string">'height'</span>, <span class="hljs-string">'round'</span>],
    },
});</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Set the DOM input values</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#fitselect'</span>).value = <span class="hljs-string">'fill'</span>;
<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#width'</span>).value = <span class="hljs-string">'400'</span>;
<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#height'</span>).value = <span class="hljs-string">'400'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Dev tip 1: Scrawl-canvas doesn’t add a namespace object to the Javascript global object. To see what’s going on in the Scrawl-canvas library - where all relevant SC objects are held - console log it (in the code file, not directly in the browser console):</p>

            </div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <pre><code><span class="hljs-built_in">console</span>.log(scrawl.library);</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <ul>
<li>doesn’t update in real time, but closing and opening the object in the console should reveal values at the point in time when it is reopened</li>
<li>In Chrome console (at least), the various objects in the library will be listed with their object type eg Stack, Canvas, Cell, etc</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>If you only want to view a specific part of the library - for example, just artefacts - console log it out in the same way:</p>

            </div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <pre><code><span class="hljs-built_in">console</span>.log(scrawl.library.artefact);</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Dev tip 2: to see what’s going on in any hidden canvas, temporarily add it to the bottom of the page, or insert it wherever using appropriate DOM API functionality:</p>

            </div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <pre><code><span class="hljs-built_in">document</span>.body.appendChild(scrawl.library.cell[NAME].element);</code></pre>
            </div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
