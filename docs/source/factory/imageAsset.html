<!DOCTYPE html>

<html>
<head>
  <title>ImageAsset factory</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="../../demo/canvas-001.html">
                  ./demo/canvas-001.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-002.html">
                  ./demo/canvas-002.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-003.html">
                  ./demo/canvas-003.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-004.html">
                  ./demo/canvas-004.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-005.html">
                  ./demo/canvas-005.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-006.html">
                  ./demo/canvas-006.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-007.html">
                  ./demo/canvas-007.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-008.html">
                  ./demo/canvas-008.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-009.html">
                  ./demo/canvas-009.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-010.html">
                  ./demo/canvas-010.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-011.html">
                  ./demo/canvas-011.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-012.html">
                  ./demo/canvas-012.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-013.html">
                  ./demo/canvas-013.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-014.html">
                  ./demo/canvas-014.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-015.html">
                  ./demo/canvas-015.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-016.html">
                  ./demo/canvas-016.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-017.html">
                  ./demo/canvas-017.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-018.html">
                  ./demo/canvas-018.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-019.html">
                  ./demo/canvas-019.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-020.html">
                  ./demo/canvas-020.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-021.html">
                  ./demo/canvas-021.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-022.html">
                  ./demo/canvas-022.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-023.html">
                  ./demo/canvas-023.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-024.html">
                  ./demo/canvas-024.js
                </a>
              
                
                <a class="source" href="../../demo/component-001.html">
                  ./demo/component-001.js
                </a>
              
                
                <a class="source" href="../../demo/component-002.html">
                  ./demo/component-002.js
                </a>
              
                
                <a class="source" href="../../demo/component-003.html">
                  ./demo/component-003.js
                </a>
              
                
                <a class="source" href="../../demo/component-004.html">
                  ./demo/component-004.js
                </a>
              
                
                <a class="source" href="../../demo/components/test-001.html">
                  ./demo/components/test-001.js
                </a>
              
                
                <a class="source" href="../../demo/components/test-002.html">
                  ./demo/components/test-002.js
                </a>
              
                
                <a class="source" href="../../demo/core-001.html">
                  ./demo/core-001.js
                </a>
              
                
                <a class="source" href="../../demo/dom-001.html">
                  ./demo/dom-001.js
                </a>
              
                
                <a class="source" href="../../demo/dom-002.html">
                  ./demo/dom-002.js
                </a>
              
                
                <a class="source" href="../../demo/dom-003.html">
                  ./demo/dom-003.js
                </a>
              
                
                <a class="source" href="../../demo/dom-004.html">
                  ./demo/dom-004.js
                </a>
              
                
                <a class="source" href="../../demo/dom-005.html">
                  ./demo/dom-005.js
                </a>
              
                
                <a class="source" href="../../demo/dom-006.html">
                  ./demo/dom-006.js
                </a>
              
                
                <a class="source" href="../../demo/dom-007.html">
                  ./demo/dom-007.js
                </a>
              
                
                <a class="source" href="../../demo/dom-008.html">
                  ./demo/dom-008.js
                </a>
              
                
                <a class="source" href="../../demo/dom-009.html">
                  ./demo/dom-009.js
                </a>
              
                
                <a class="source" href="../../demo/dom-010.html">
                  ./demo/dom-010.js
                </a>
              
                
                <a class="source" href="../../demo/dom-011.html">
                  ./demo/dom-011.js
                </a>
              
                
                <a class="source" href="../../demo/dom-012.html">
                  ./demo/dom-012.js
                </a>
              
                
                <a class="source" href="../../demo/dom-013.html">
                  ./demo/dom-013.js
                </a>
              
                
                <a class="source" href="../../demo/dom-014a.html">
                  ./demo/dom-014a.js
                </a>
              
                
                <a class="source" href="../../demo/dom-014b.html">
                  ./demo/dom-014b.js
                </a>
              
                
                <a class="source" href="../../demo/dom-014c.html">
                  ./demo/dom-014c.js
                </a>
              
                
                <a class="source" href="../../demo/dom-015.html">
                  ./demo/dom-015.js
                </a>
              
                
                <a class="source" href="../core/animationloop.html">
                  ./source/core/animationloop.js
                </a>
              
                
                <a class="source" href="../core/document.html">
                  ./source/core/document.js
                </a>
              
                
                <a class="source" href="../core/init.html">
                  ./source/core/init.js
                </a>
              
                
                <a class="source" href="../core/library.html">
                  ./source/core/library.js
                </a>
              
                
                <a class="source" href="../core/userInteraction.html">
                  ./source/core/userInteraction.js
                </a>
              
                
                <a class="source" href="../core/utilities.html">
                  ./source/core/utilities.js
                </a>
              
                
                <a class="source" href="action.html">
                  ./source/factory/action.js
                </a>
              
                
                <a class="source" href="anchor.html">
                  ./source/factory/anchor.js
                </a>
              
                
                <a class="source" href="animation.html">
                  ./source/factory/animation.js
                </a>
              
                
                <a class="source" href="block.html">
                  ./source/factory/block.js
                </a>
              
                
                <a class="source" href="canvas.html">
                  ./source/factory/canvas.js
                </a>
              
                
                <a class="source" href="cell.html">
                  ./source/factory/cell.js
                </a>
              
                
                <a class="source" href="color.html">
                  ./source/factory/color.js
                </a>
              
                
                <a class="source" href="coordinate.html">
                  ./source/factory/coordinate.js
                </a>
              
                
                <a class="source" href="element.html">
                  ./source/factory/element.js
                </a>
              
                
                <a class="source" href="filter.html">
                  ./source/factory/filter.js
                </a>
              
                
                <a class="source" href="fontAttributes.html">
                  ./source/factory/fontAttributes.js
                </a>
              
                
                <a class="source" href="gradient.html">
                  ./source/factory/gradient.js
                </a>
              
                
                <a class="source" href="grid.html">
                  ./source/factory/grid.js
                </a>
              
                
                <a class="source" href="group.html">
                  ./source/factory/group.js
                </a>
              
                
                <a class="source" href="imageAsset.html">
                  ./source/factory/imageAsset.js
                </a>
              
                
                <a class="source" href="loom.html">
                  ./source/factory/loom.js
                </a>
              
                
                <a class="source" href="palette.html">
                  ./source/factory/palette.js
                </a>
              
                
                <a class="source" href="pattern.html">
                  ./source/factory/pattern.js
                </a>
              
                
                <a class="source" href="phrase.html">
                  ./source/factory/phrase.js
                </a>
              
                
                <a class="source" href="picture.html">
                  ./source/factory/picture.js
                </a>
              
                
                <a class="source" href="quaternion.html">
                  ./source/factory/quaternion.js
                </a>
              
                
                <a class="source" href="radialGradient.html">
                  ./source/factory/radialGradient.js
                </a>
              
                
                <a class="source" href="shape.html">
                  ./source/factory/shape.js
                </a>
              
                
                <a class="source" href="spriteAsset.html">
                  ./source/factory/spriteAsset.js
                </a>
              
                
                <a class="source" href="stack.html">
                  ./source/factory/stack.js
                </a>
              
                
                <a class="source" href="state.html">
                  ./source/factory/state.js
                </a>
              
                
                <a class="source" href="ticker.html">
                  ./source/factory/ticker.js
                </a>
              
                
                <a class="source" href="tween.html">
                  ./source/factory/tween.js
                </a>
              
                
                <a class="source" href="unstackedElement.html">
                  ./source/factory/unstackedElement.js
                </a>
              
                
                <a class="source" href="userObject.html">
                  ./source/factory/userObject.js
                </a>
              
                
                <a class="source" href="vector.html">
                  ./source/factory/vector.js
                </a>
              
                
                <a class="source" href="videoAsset.html">
                  ./source/factory/videoAsset.js
                </a>
              
                
                <a class="source" href="wheel.html">
                  ./source/factory/wheel.js
                </a>
              
                
                <a class="source" href="../mixin/anchor.html">
                  ./source/mixin/anchor.js
                </a>
              
                
                <a class="source" href="../mixin/asset.html">
                  ./source/mixin/asset.js
                </a>
              
                
                <a class="source" href="../mixin/assetConsumer.html">
                  ./source/mixin/assetConsumer.js
                </a>
              
                
                <a class="source" href="../mixin/base.html">
                  ./source/mixin/base.js
                </a>
              
                
                <a class="source" href="../mixin/cascade.html">
                  ./source/mixin/cascade.js
                </a>
              
                
                <a class="source" href="../mixin/dom.html">
                  ./source/mixin/dom.js
                </a>
              
                
                <a class="source" href="../mixin/entity.html">
                  ./source/mixin/entity.js
                </a>
              
                
                <a class="source" href="../mixin/filter.html">
                  ./source/mixin/filter.js
                </a>
              
                
                <a class="source" href="../mixin/position.html">
                  ./source/mixin/position.js
                </a>
              
                
                <a class="source" href="../mixin/shapePathCalculation.html">
                  ./source/mixin/shapePathCalculation.js
                </a>
              
                
                <a class="source" href="../mixin/styles.html">
                  ./source/mixin/styles.js
                </a>
              
                
                <a class="source" href="../mixin/tween.html">
                  ./source/mixin/tween.js
                </a>
              
                
                <a class="source" href="../scrawl.html">
                  ./source/scrawl.js
                </a>
              
                
                <a class="source" href="../worker/filter.html">
                  ./source/worker/filter.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h1 id="imageasset-factory">ImageAsset factory</h1>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>TODO - documentation</p>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <h4 id="to-instantiate-objects-from-the-factory">To instantiate objects from the factory</h4>

            </div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <h4 id="library-storage">Library storage</h4>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h4 id="clone-functionality">Clone functionality</h4>

            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <h4 id="kill-functionality">Kill functionality</h4>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">import</span> { constructors, canvas, cell, group, artefact } <span class="hljs-keyword">from</span> <span class="hljs-string">'../core/library.js'</span>;
<span class="hljs-keyword">import</span> { mergeOver, isa_obj } <span class="hljs-keyword">from</span> <span class="hljs-string">'../core/utilities.js'</span>;

<span class="hljs-keyword">import</span> baseMix <span class="hljs-keyword">from</span> <span class="hljs-string">'../mixin/base.js'</span>;
<span class="hljs-keyword">import</span> assetMix <span class="hljs-keyword">from</span> <span class="hljs-string">'../mixin/asset.js'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <h2 id="imageasset-constructor">ImageAsset constructor</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> ImageAsset = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">items = {}</span>) </span>{

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.assetConstructor(items);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h2 id="imageasset-object-prototype-setup">ImageAsset object prototype setup</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> P = ImageAsset.prototype = <span class="hljs-built_in">Object</span>.create(<span class="hljs-built_in">Object</span>.prototype);
P.type = <span class="hljs-string">'Image'</span>;
P.lib = <span class="hljs-string">'asset'</span>;
P.isArtefact = <span class="hljs-literal">false</span>;
P.isAsset = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Apply mixins to prototype object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P = baseMix(P);
P = assetMix(P);</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <h2 id="packet-management">Packet management</h2>

            </div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Currently nothing to do here</p>

            </div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>TODO: work out how we’re going to handle assets in packages
    - currently assume asset already exists on the destination device browser
    - we could include the &lt;img&gt; element’s src attribute in the packet??
    - then when it comes to unpacking, check if it really does exist
        - if not exist, do the load thing</p>

            </div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <pre><code>- same work required across imageAsset, spriteAsset, videoAsset</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h2 id="define-default-attributes">Define default attributes</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> defaultAttributes = {};
P.defs = mergeOver(P.defs, defaultAttributes);

<span class="hljs-keyword">let</span> G = P.getters,
    S = P.setters,
    D = P.deltaSetters;</pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>TODO - documentation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>S.source = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item = {}</span>) </span>{

    <span class="hljs-keyword">if</span> (item) {</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>For &lt;img&gt; and &lt;picture&gt; elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> ([<span class="hljs-string">'IMG'</span>, <span class="hljs-string">'PICTURE'</span>].indexOf(item.tagName.toUpperCase()) &gt;= <span class="hljs-number">0</span>) {

            <span class="hljs-keyword">this</span>.source = item;
            <span class="hljs-keyword">this</span>.sourceNaturalWidth = item.naturalWidth;
            <span class="hljs-keyword">this</span>.sourceNaturalHeight = item.naturalHeight;
            <span class="hljs-keyword">this</span>.sourceLoaded = item.complete;
        }

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sourceLoaded) <span class="hljs-keyword">this</span>.notifySubscribers();
    }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <h2 id="define-prototype-functions">Define prototype functions</h2>

            </div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>TODO - documentation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.checkSource = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">width, height</span>) </span>{

    <span class="hljs-keyword">let</span> el = <span class="hljs-keyword">this</span>.source;

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sourceLoaded) {

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.sourceNaturalWidth !== el.naturalWidth || 
                <span class="hljs-keyword">this</span>.sourceNaturalHeight !== el.naturalHeight || 
                <span class="hljs-keyword">this</span>.sourceNaturalWidth !== width ||
                <span class="hljs-keyword">this</span>.sourceNaturalHeight !== height) {

            <span class="hljs-keyword">this</span>.sourceNaturalWidth = el.naturalWidth;
            <span class="hljs-keyword">this</span>.sourceNaturalHeight = el.naturalHeight;

            <span class="hljs-keyword">this</span>.notifySubscribers();
        }
    }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>TODO - documentation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> gettableImageAssetAtributes = [];
<span class="hljs-keyword">const</span> settableImageAssetAtributes = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Import images from wherever</p>

            </div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Arguments can be either string urls - ‘<a href="http://www.example.com/path/to/image/flower.jpg&#39;">http://www.example.com/path/to/image/flower.jpg&#39;</a> - in which case Scrawl-canvas:</p>

            </div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <ul>
<li>will attempt to give the new imageAsset object, and img element, a name/id value of eg ‘flower’ (but not guaranteed)</li>
<li>will not add the new img element to the DOM</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>… or the argument can be an object with the following attributes:</p>

            </div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <ul>
<li><strong>name</strong> string</li>
<li><strong>src</strong> url string</li>
<li><strong>parent</strong> CSS search string - if set, Scrawl-canvas will attempt to append the new img element to the corresponding DOM element</li>
<li><strong>isVisible</strong> boolean - if true, and new img element has been added to DOM, make that image visible; default is false</li>
<li><strong>className</strong> string - list of classes to be added to the new img element</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> importImage = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) </span>{

    <span class="hljs-keyword">let</span> reg = <span class="hljs-regexp">/.*\/(.*?)\./</span>,
        results = [];

    args.forEach(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {

        <span class="hljs-keyword">let</span> name, url, className, visibility, 
            parent = <span class="hljs-literal">false</span>;

        <span class="hljs-keyword">let</span> flag = <span class="hljs-literal">false</span>;

        <span class="hljs-keyword">if</span> (item.substring) {

            <span class="hljs-keyword">let</span> match = reg.exec(item);

            name = (match &amp;&amp; match[<span class="hljs-number">1</span>]) ? match[<span class="hljs-number">1</span>] : <span class="hljs-string">''</span>;
            url = item;
            className = <span class="hljs-string">''</span>;
            visibility = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>parent = null;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
            flag = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">else</span> {

            item = (isa_obj(item)) ? item : <span class="hljs-literal">false</span>;

            <span class="hljs-keyword">if</span> (item &amp;&amp; item.src) {

                name = item.name || <span class="hljs-string">''</span>;

                url = item.src;
                className = item.className || <span class="hljs-string">''</span>;
                visibility = item.visibility || <span class="hljs-literal">false</span>;
                <span class="hljs-keyword">if</span> (item.parent) parent = <span class="hljs-built_in">document</span>.querySelector(item.parent);

                flag = <span class="hljs-literal">true</span>;
            }
        }    

        <span class="hljs-keyword">if</span> (flag) {

            <span class="hljs-keyword">let</span> image = makeImageAsset({
                <span class="hljs-attr">name</span>: name,
            });

            <span class="hljs-keyword">let</span> img = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'img'</span>);

            img.name = name;
            img.className = className;
            img.crossorigin = <span class="hljs-string">'anonymous'</span>;

            img.style.display = (visibility) ? <span class="hljs-string">'block'</span> : <span class="hljs-string">'none'</span>;

            <span class="hljs-keyword">if</span> (parent) parent.appendChild(img);
            
            img.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {

                image.set({
                    <span class="hljs-attr">source</span>: img,
                });
            };
            
            img.src = url;

            image.set({
                <span class="hljs-attr">source</span>: img,
            });

            results.push(name);
        }
        <span class="hljs-keyword">else</span> results.push(<span class="hljs-literal">false</span>);
    });
    <span class="hljs-keyword">return</span> results;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Import images from the DOM</p>

            </div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Required argument is a query string used to search the dom for matching elements</p>

            </div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Note: unlike in Scrawl-canvas v7, img elements imported from the DOM will always remain in the DOM. If those img elements should not appear on the web page or scene, then coders will need to hide them in some way - either by: positioning them (or their parent element) absolutely to the top or left of the display; or giving their parent element zero width/height; or by setting the img or parent element’s style.display attribute to ‘none’, or their style.opacity attribute’s value to 0 … or some other clever way to hide them.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> importDomImage = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">query</span>) </span>{

    <span class="hljs-keyword">let</span> reg = <span class="hljs-regexp">/.*\/(.*?)\./</span>;

    <span class="hljs-keyword">let</span> items = <span class="hljs-built_in">document</span>.querySelectorAll(query);

    items.forEach(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> {

        <span class="hljs-keyword">let</span> name;

        <span class="hljs-keyword">if</span> ([<span class="hljs-string">'IMG'</span>, <span class="hljs-string">'PICTURE'</span>].indexOf(item.tagName.toUpperCase()) &gt;= <span class="hljs-number">0</span>) {

            <span class="hljs-keyword">if</span> (item.id || item.name) name = item.id || item.name;
            <span class="hljs-keyword">else</span> {

                <span class="hljs-keyword">let</span> match = reg.exec(item.src);
                name = (match &amp;&amp; match[<span class="hljs-number">1</span>]) ? match[<span class="hljs-number">1</span>] : <span class="hljs-string">''</span>;
            }

            <span class="hljs-keyword">let</span> image = makeImageAsset({
                <span class="hljs-attr">name</span>: name,
                <span class="hljs-attr">source</span>: item,
            });

            item.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {

                image.set({
                    <span class="hljs-attr">source</span>: item,
                });
            };
        }
    });
};</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>We can get cells, groups and entitys to save their output as imagedata, which we can then use to build an asset which in turn can be used by Picture entitys and pattern styles</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> createImageFromCell = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item, stashAsAsset = false</span>) </span>{

    <span class="hljs-keyword">let</span> mycell = (item.substring) ? cell[item] || canvas[item] : item;

    <span class="hljs-keyword">if</span> (mycell.type === <span class="hljs-string">'Canvas'</span>) mycell = mycell.base;

    <span class="hljs-keyword">if</span> (mycell.type === <span class="hljs-string">'Cell'</span>) {

        mycell.stashOutput = <span class="hljs-literal">true</span>;

        <span class="hljs-keyword">if</span> (stashAsAsset) mycell.stashOutputAsAsset = <span class="hljs-literal">true</span>;
    }
};

<span class="hljs-keyword">const</span> createImageFromGroup = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item, stashAsAsset = false</span>) </span>{

    <span class="hljs-keyword">let</span> mygroup;

    <span class="hljs-keyword">if</span> (item &amp;&amp; !item.substring) {

        <span class="hljs-keyword">if</span> (item.type === <span class="hljs-string">'Group'</span>) mygroup = item;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item.type === <span class="hljs-string">'Cell'</span>) mygroup = group[item.name];
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item.type === <span class="hljs-string">'Canvas'</span>) mygroup = group[item.base.name];
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (item &amp;&amp; item.substring) mygroup = group[item];

    <span class="hljs-keyword">if</span> (mygroup) {

        mygroup.stashOutput = <span class="hljs-literal">true</span>;

        <span class="hljs-keyword">if</span> (stashAsAsset) mygroup.stashOutputAsAsset = <span class="hljs-literal">true</span>;
    }
};

<span class="hljs-keyword">const</span> createImageFromEntity = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item, stashAsAsset = false</span>) </span>{

    <span class="hljs-keyword">let</span> myentity = (item.substring) ? artefact[item] : item;

    <span class="hljs-keyword">if</span> (myentity.isArtefact) {

        myentity.stashOutput = <span class="hljs-literal">true</span>;

        <span class="hljs-keyword">if</span> (stashAsAsset) myentity.stashOutputAsAsset = <span class="hljs-literal">true</span>;
    }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <h2 id="exported-factory-function">Exported factory function</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> makeImageAsset = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">items</span>) </span>{

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ImageAsset(items);
};

constructors.ImageAsset = ImageAsset;

<span class="hljs-keyword">export</span> {
    makeImageAsset,

    gettableImageAssetAtributes,
    settableImageAssetAtributes,

    importImage,
    importDomImage,

    createImageFromCell,
    createImageFromGroup,
    createImageFromEntity,
};</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
