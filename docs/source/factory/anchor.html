<!DOCTYPE html>

<html>
<head>
  <title>Anchor factory</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="../../docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page_wrapper">
            <div id="jump_page">
              
                
                <a class="source" href="../../demo/canvas-001.html">
                  ./demo/canvas-001.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-002.html">
                  ./demo/canvas-002.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-003.html">
                  ./demo/canvas-003.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-004.html">
                  ./demo/canvas-004.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-005.html">
                  ./demo/canvas-005.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-006.html">
                  ./demo/canvas-006.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-007.html">
                  ./demo/canvas-007.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-008.html">
                  ./demo/canvas-008.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-009.html">
                  ./demo/canvas-009.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-010.html">
                  ./demo/canvas-010.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-011.html">
                  ./demo/canvas-011.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-012.html">
                  ./demo/canvas-012.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-013.html">
                  ./demo/canvas-013.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-014.html">
                  ./demo/canvas-014.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-015.html">
                  ./demo/canvas-015.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-016.html">
                  ./demo/canvas-016.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-017.html">
                  ./demo/canvas-017.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-018.html">
                  ./demo/canvas-018.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-019.html">
                  ./demo/canvas-019.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-020.html">
                  ./demo/canvas-020.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-021.html">
                  ./demo/canvas-021.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-022.html">
                  ./demo/canvas-022.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-023.html">
                  ./demo/canvas-023.js
                </a>
              
                
                <a class="source" href="../../demo/canvas-024.html">
                  ./demo/canvas-024.js
                </a>
              
                
                <a class="source" href="../../demo/component-001.html">
                  ./demo/component-001.js
                </a>
              
                
                <a class="source" href="../../demo/component-002.html">
                  ./demo/component-002.js
                </a>
              
                
                <a class="source" href="../../demo/component-003.html">
                  ./demo/component-003.js
                </a>
              
                
                <a class="source" href="../../demo/component-004.html">
                  ./demo/component-004.js
                </a>
              
                
                <a class="source" href="../../demo/components/test-001.html">
                  ./demo/components/test-001.js
                </a>
              
                
                <a class="source" href="../../demo/components/test-002.html">
                  ./demo/components/test-002.js
                </a>
              
                
                <a class="source" href="../../demo/core-001.html">
                  ./demo/core-001.js
                </a>
              
                
                <a class="source" href="../../demo/dom-001.html">
                  ./demo/dom-001.js
                </a>
              
                
                <a class="source" href="../../demo/dom-002.html">
                  ./demo/dom-002.js
                </a>
              
                
                <a class="source" href="../../demo/dom-003.html">
                  ./demo/dom-003.js
                </a>
              
                
                <a class="source" href="../../demo/dom-004.html">
                  ./demo/dom-004.js
                </a>
              
                
                <a class="source" href="../../demo/dom-005.html">
                  ./demo/dom-005.js
                </a>
              
                
                <a class="source" href="../../demo/dom-006.html">
                  ./demo/dom-006.js
                </a>
              
                
                <a class="source" href="../../demo/dom-007.html">
                  ./demo/dom-007.js
                </a>
              
                
                <a class="source" href="../../demo/dom-008.html">
                  ./demo/dom-008.js
                </a>
              
                
                <a class="source" href="../../demo/dom-009.html">
                  ./demo/dom-009.js
                </a>
              
                
                <a class="source" href="../../demo/dom-010.html">
                  ./demo/dom-010.js
                </a>
              
                
                <a class="source" href="../../demo/dom-011.html">
                  ./demo/dom-011.js
                </a>
              
                
                <a class="source" href="../../demo/dom-012.html">
                  ./demo/dom-012.js
                </a>
              
                
                <a class="source" href="../../demo/dom-013.html">
                  ./demo/dom-013.js
                </a>
              
                
                <a class="source" href="../../demo/dom-014a.html">
                  ./demo/dom-014a.js
                </a>
              
                
                <a class="source" href="../../demo/dom-014b.html">
                  ./demo/dom-014b.js
                </a>
              
                
                <a class="source" href="../../demo/dom-014c.html">
                  ./demo/dom-014c.js
                </a>
              
                
                <a class="source" href="../../demo/dom-015.html">
                  ./demo/dom-015.js
                </a>
              
                
                <a class="source" href="../core/animationloop.html">
                  ./source/core/animationloop.js
                </a>
              
                
                <a class="source" href="../core/document.html">
                  ./source/core/document.js
                </a>
              
                
                <a class="source" href="../core/init.html">
                  ./source/core/init.js
                </a>
              
                
                <a class="source" href="../core/library.html">
                  ./source/core/library.js
                </a>
              
                
                <a class="source" href="../core/userInteraction.html">
                  ./source/core/userInteraction.js
                </a>
              
                
                <a class="source" href="../core/utilities.html">
                  ./source/core/utilities.js
                </a>
              
                
                <a class="source" href="action.html">
                  ./source/factory/action.js
                </a>
              
                
                <a class="source" href="anchor.html">
                  ./source/factory/anchor.js
                </a>
              
                
                <a class="source" href="animation.html">
                  ./source/factory/animation.js
                </a>
              
                
                <a class="source" href="block.html">
                  ./source/factory/block.js
                </a>
              
                
                <a class="source" href="canvas.html">
                  ./source/factory/canvas.js
                </a>
              
                
                <a class="source" href="cell.html">
                  ./source/factory/cell.js
                </a>
              
                
                <a class="source" href="color.html">
                  ./source/factory/color.js
                </a>
              
                
                <a class="source" href="coordinate.html">
                  ./source/factory/coordinate.js
                </a>
              
                
                <a class="source" href="element.html">
                  ./source/factory/element.js
                </a>
              
                
                <a class="source" href="filter.html">
                  ./source/factory/filter.js
                </a>
              
                
                <a class="source" href="fontAttributes.html">
                  ./source/factory/fontAttributes.js
                </a>
              
                
                <a class="source" href="gradient.html">
                  ./source/factory/gradient.js
                </a>
              
                
                <a class="source" href="grid.html">
                  ./source/factory/grid.js
                </a>
              
                
                <a class="source" href="group.html">
                  ./source/factory/group.js
                </a>
              
                
                <a class="source" href="imageAsset.html">
                  ./source/factory/imageAsset.js
                </a>
              
                
                <a class="source" href="loom.html">
                  ./source/factory/loom.js
                </a>
              
                
                <a class="source" href="palette.html">
                  ./source/factory/palette.js
                </a>
              
                
                <a class="source" href="pattern.html">
                  ./source/factory/pattern.js
                </a>
              
                
                <a class="source" href="phrase.html">
                  ./source/factory/phrase.js
                </a>
              
                
                <a class="source" href="picture.html">
                  ./source/factory/picture.js
                </a>
              
                
                <a class="source" href="quaternion.html">
                  ./source/factory/quaternion.js
                </a>
              
                
                <a class="source" href="radialGradient.html">
                  ./source/factory/radialGradient.js
                </a>
              
                
                <a class="source" href="shape.html">
                  ./source/factory/shape.js
                </a>
              
                
                <a class="source" href="spriteAsset.html">
                  ./source/factory/spriteAsset.js
                </a>
              
                
                <a class="source" href="stack.html">
                  ./source/factory/stack.js
                </a>
              
                
                <a class="source" href="state.html">
                  ./source/factory/state.js
                </a>
              
                
                <a class="source" href="ticker.html">
                  ./source/factory/ticker.js
                </a>
              
                
                <a class="source" href="tween.html">
                  ./source/factory/tween.js
                </a>
              
                
                <a class="source" href="unstackedElement.html">
                  ./source/factory/unstackedElement.js
                </a>
              
                
                <a class="source" href="userObject.html">
                  ./source/factory/userObject.js
                </a>
              
                
                <a class="source" href="vector.html">
                  ./source/factory/vector.js
                </a>
              
                
                <a class="source" href="videoAsset.html">
                  ./source/factory/videoAsset.js
                </a>
              
                
                <a class="source" href="wheel.html">
                  ./source/factory/wheel.js
                </a>
              
                
                <a class="source" href="../mixin/anchor.html">
                  ./source/mixin/anchor.js
                </a>
              
                
                <a class="source" href="../mixin/asset.html">
                  ./source/mixin/asset.js
                </a>
              
                
                <a class="source" href="../mixin/assetConsumer.html">
                  ./source/mixin/assetConsumer.js
                </a>
              
                
                <a class="source" href="../mixin/base.html">
                  ./source/mixin/base.js
                </a>
              
                
                <a class="source" href="../mixin/cascade.html">
                  ./source/mixin/cascade.js
                </a>
              
                
                <a class="source" href="../mixin/dom.html">
                  ./source/mixin/dom.js
                </a>
              
                
                <a class="source" href="../mixin/entity.html">
                  ./source/mixin/entity.js
                </a>
              
                
                <a class="source" href="../mixin/filter.html">
                  ./source/mixin/filter.js
                </a>
              
                
                <a class="source" href="../mixin/position.html">
                  ./source/mixin/position.js
                </a>
              
                
                <a class="source" href="../mixin/shapePathCalculation.html">
                  ./source/mixin/shapePathCalculation.js
                </a>
              
                
                <a class="source" href="../mixin/styles.html">
                  ./source/mixin/styles.js
                </a>
              
                
                <a class="source" href="../mixin/tween.html">
                  ./source/mixin/tween.js
                </a>
              
                
                <a class="source" href="../scrawl.html">
                  ./source/scrawl.js
                </a>
              
                
                <a class="source" href="../worker/filter.html">
                  ./source/worker/filter.js
                </a>
              
            </div>
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h1 id="anchor-factory">Anchor factory</h1>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>In Scrawl-canvas, an anchor object holds all the data and functionality required to turn an artefact into a link. That functionality gets defined in this file. </p>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Scrawl-canvas uses a mixin (code kept in ./mixin/anchor.js) to add anchor functionality to artefacts - in particular canvas entitys.</p>

            </div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>This gives us a interactive canvas containing dynamic, clickable regions.</p>

            </div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Note that while anchors are primarily for generating URL links to (external site) web pages, they can also be used to trigger any other desired action. This can be achieved by setting the anchor object’s <strong>clickAction</strong> attribute to a function. For instance:</p>

            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <ul>
<li>We can define a clickAction which emits a Google Analytics tracker message before performing the URL navigation (see demo Canvas-009)</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <ul>
<li>We can suppress the click action (via ‘preventDefault’) and instead action code supplied by a third party library - though there’s usually better ways to achieve this via other Scrawl-canvas functionalities, for instance by using Scrawl-canvas enhanced event listeners or artefact functions (onEnter, onLeave, onDown, onUp).</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <h4 id="instantiate-objects-from-the-factory-no">Instantiate objects from the factory: NO</h4>

            </div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>NOTE - generating an anchor will have an impact on the DOM document code, as an (off-viewport) &lt;a&gt; element will be added to it.</p>

            </div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>The <strong>makeAnchor</strong> function is not exposed to the ‘scrawl’ object, thus objects can only be created indirectly.</p>

            </div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>To create an anchor, include an anchor definition object in any artefact object’s factory argument:</p>

            </div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <pre><code><span class="hljs-comment">// get a handle on the canvas where the block/link will be defined </span>
<span class="hljs-comment">// (in this case a canvas with id="mycanvas")</span>
<span class="hljs-keyword">let</span> canvas = scrawl.library.artefact.mycanvas;
canvas.setAsCurrentCanvas();</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <pre><code><span class="hljs-comment">// Define a block entity</span>
scrawl.makeBlock({</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <pre><code>    name: <span class="hljs-string">'demo-anchor-block'</span>,</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <pre><code>    width: <span class="hljs-string">'40%'</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-string">'40%'</span>,</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <pre><code>    startX: <span class="hljs-string">'25%'</span>,
    <span class="hljs-attr">startY</span>: <span class="hljs-string">'25%'</span>,</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <pre><code>    <span class="hljs-comment">// Define the anchor object's attributes</span>
    <span class="hljs-attr">anchor</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'wikipedia-water-link'</span>,
        <span class="hljs-attr">href</span>: <span class="hljs-string">'https://en.wikipedia.org/wiki/Water'</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">'Link to the Wikipedia article on water (opens in new tab)'</span>,
    },</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <pre><code>    <span class="hljs-comment">// Add an action to take when user clicks on the block entity</span>
    <span class="hljs-attr">onUp</span>: <span class="hljs-keyword">this</span>.clickAnchor,
});</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <pre><code><span class="hljs-comment">// Add a listener to propagate DOM-detected click events on our canvas </span>
<span class="hljs-comment">// back into the Scrawl-canvas event system</span>
<span class="hljs-keyword">let</span> mylinks = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> canvas.cascadeEventAction(<span class="hljs-string">'up'</span>);
scrawl.addListener(<span class="hljs-string">'up'</span>, mylinks, canvas.domElement);</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>The factory uses all attributes and functions defined by the ‘base’ mixin, alongside those defined in this file.</p>

            </div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <h4 id="library-storage-yes-but-">Library storage: YES, BUT …</h4>

            </div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <ul>
<li>scrawl.library.anchor</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Anchor objects have a 1-to-1 relationship with the artefacts they are created with. The anchor object is always accessible via the artefact object (at <strong>myartefact.anchor</strong>). </p>

            </div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Anchor functionality (setting its attributes, invoking its functions) can be performed on the artefact object, which maps anchor functionality onto itself.</p>

            </div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <h4 id="clone-functionality-yes-but-">Clone functionality: YES, BUT …</h4>

            </div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>An anchor object (and its associated DOM element) will be cloned when its parent artefact is cloned.</p>

            </div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <h4 id="kill-functionality-tbd">Kill functionality: (tbd)</h4>

            </div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Currently using a ‘demolish’ function</p>

            </div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>TODO: review and update kill functionality through the entire Scrawl-canvas system</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">import</span> { constructors } <span class="hljs-keyword">from</span> <span class="hljs-string">'../core/library.js'</span>;
<span class="hljs-keyword">import</span> { scrawlNavigationHold } <span class="hljs-keyword">from</span> <span class="hljs-string">'../core/document.js'</span>;
<span class="hljs-keyword">import</span> { mergeOver, pushUnique, isa_fn } <span class="hljs-keyword">from</span> <span class="hljs-string">'../core/utilities.js'</span>;

<span class="hljs-keyword">import</span> baseMix <span class="hljs-keyword">from</span> <span class="hljs-string">'../mixin/base.js'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <h2 id="anchor-constructor">Anchor constructor</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> Anchor = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">items = {}</span>) </span>{
    
    <span class="hljs-keyword">this</span>.makeName(items.name);
    <span class="hljs-keyword">this</span>.register();
    
    <span class="hljs-keyword">this</span>.set(<span class="hljs-keyword">this</span>.defs);
    <span class="hljs-keyword">this</span>.set(items);

    <span class="hljs-keyword">this</span>.build();

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <h2 id="anchor-object-prototype-setup">Anchor object prototype setup</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> P = Anchor.prototype = <span class="hljs-built_in">Object</span>.create(<span class="hljs-built_in">Object</span>.prototype);
P.type = <span class="hljs-string">'Anchor'</span>;
P.lib = <span class="hljs-string">'anchor'</span>;
P.isArtefact = <span class="hljs-literal">false</span>;
P.isAsset = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Apply mixins to prototype object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P = baseMix(P);</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <h2 id="define-default-attributes">Define default attributes</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> defaultAttributes = {</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>The text that Scrawl-canvas will include between the anchor tags, when building the anchor. <strong>Always include a description</strong> for accessibility</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    description: <span class="hljs-string">''</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>The following attributes are detailed in <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a">https://developer.mozilla.org/en-US/docs/Web/HTML/Element/a</a> - they are (most of) the DOM element’s attributes</p>

            </div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <ul>
<li>the HTML Anchor element ‘type’ attribute is stored in the Scrawl-canvas Anchor object using the key ‘anchorType’</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Scrawl-canvas will build a link element and add it to the DOM, then invoke a click event on it when required to do so.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    download: <span class="hljs-string">''</span>,
    <span class="hljs-attr">href</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">hreflang</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">ping</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">referrerpolicy</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">rel</span>: <span class="hljs-string">'noreferrer'</span>,
    <span class="hljs-attr">target</span>: <span class="hljs-string">'_blank'</span>,
    <span class="hljs-attr">anchorType</span>: <span class="hljs-string">''</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>The <strong>clickAction</strong> attribute is a <strong><em>function which returns a string command</em></strong> which in turn gets attached to the anchor DOM element’s <strong>onclick</strong> attribute. Invoking the result is handled entirely by the browser (as is normal).</p>

            </div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Example usage</p>

            </div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>This <strong>doesn’t work!</strong> The browser will generate an error, rather than output an update to the console, when the user clicks on the canvas entity associated with the anchor (although navigation will still occur - the wikipedia page will open in a new browser tab):</p>

            </div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <pre><code>anchor: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'wikipedia-box-link'</span>,
    <span class="hljs-attr">href</span>: <span class="hljs-string">'https://en.wikipedia.org/wiki/Box'</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'Link to the Wikipedia article on boxes (opens in new tab)'</span>,</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <pre><code>    clickAction: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'box clicked'</span>) },
}</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>This <strong>works as expected</strong> - the function returns a string which can then be attached to the &lt;a&gt; DOM element’s <em>onclick</em> attribute:</p>

            </div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <pre><code>anchor: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'wikipedia-box-link'</span>,
    <span class="hljs-attr">href</span>: <span class="hljs-string">'https://en.wikipedia.org/wiki/Box'</span>,
    <span class="hljs-attr">description</span>: <span class="hljs-string">'Link to the Wikipedia article on boxes (opens in new tab)'</span>,</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <pre><code>    clickAction: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-string">`console.log('box clicked')`</span> },
},</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    clickAction: <span class="hljs-literal">null</span>,
};
P.defs = mergeOver(P.defs, defaultAttributes);</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <h2 id="packet-management">Packet management</h2>

            </div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Overwriting base mixin functions.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.packetExclusions = pushUnique(P.packetExclusions, [<span class="hljs-string">'domElement'</span>]);
P.packetFunctions = pushUnique(P.packetFunctions, [<span class="hljs-string">'clickAction'</span>]);</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <h2 id="define-attribute-getters-and-setters">Define attribute getters and setters</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">let</span> S = P.setters;</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>While the Scrawl-canvas anchor object keeps copies of all of its &lt;a&gt; DOM element’s attributes locally, they also need to be updated on that element. Most of the setter functions manage this using the anchor.update() helper function.</p>

            </div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>The artefact with which an anchor object is associated maps these attributes to itself as follows:</p>

            </div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <pre><code>anchor.description     -&gt; artefact.anchorDescription
anchor.type            -&gt; artefact.anchorType
anchor.target          -&gt; artefact.anchorTarget
anchor.rel             -&gt; artefact.anchorRel
anchor.referrerPolicy  -&gt; artefact.anchorReferrerPolicy
anchor.ping            -&gt; artefact.anchorPing
anchor.hreflang        -&gt; artefact.anchorHreflang
anchor.href            -&gt; artefact.anchorHref
anchor.download        -&gt; artefact.anchorDownload</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>One or more of these attributes can also be set (in the artefact factory argument, or when invoking artefact.set) using an ‘anchor’ attribute:</p>

            </div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <pre><code>artefact.set({</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <pre><code>    anchor: {
        <span class="hljs-attr">description</span>: <span class="hljs-string">'value'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'value'</span>,
        <span class="hljs-attr">target</span>: <span class="hljs-string">'value'</span>,
        <span class="hljs-attr">rel</span>: <span class="hljs-string">'value'</span>,
        <span class="hljs-attr">referrerPolicy</span>: <span class="hljs-string">'value'</span>,
        <span class="hljs-attr">ping</span>: <span class="hljs-string">'value'</span>,
        <span class="hljs-attr">hreflang</span>: <span class="hljs-string">'value'</span>,
        <span class="hljs-attr">href</span>: <span class="hljs-string">'value'</span>,
        <span class="hljs-attr">download</span>: <span class="hljs-string">'value'</span>,
    },
});</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>S.download = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{

    <span class="hljs-keyword">this</span>.download = item;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) <span class="hljs-keyword">this</span>.update(<span class="hljs-string">'download'</span>);
};

S.href = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{

    <span class="hljs-keyword">this</span>.href = item;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) <span class="hljs-keyword">this</span>.update(<span class="hljs-string">'href'</span>);
};

S.hreflang = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{

    <span class="hljs-keyword">this</span>.hreflang = item;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) <span class="hljs-keyword">this</span>.update(<span class="hljs-string">'hreflang'</span>);
};

S.ping = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{

    <span class="hljs-keyword">this</span>.ping = item;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) <span class="hljs-keyword">this</span>.update(<span class="hljs-string">'ping'</span>);
};

S.referrerpolicy = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{

    <span class="hljs-keyword">this</span>.referrerpolicy = item;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) <span class="hljs-keyword">this</span>.update(<span class="hljs-string">'referrerpolicy'</span>);
};

S.rel = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{

    <span class="hljs-keyword">this</span>.rel = item;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) <span class="hljs-keyword">this</span>.update(<span class="hljs-string">'rel'</span>);
};

S.target = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{

    <span class="hljs-keyword">this</span>.target = item;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) <span class="hljs-keyword">this</span>.update(<span class="hljs-string">'target'</span>);
};

S.anchorType = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{

    <span class="hljs-keyword">this</span>.anchorType = item;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) <span class="hljs-keyword">this</span>.update(<span class="hljs-string">'type'</span>);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>These last setters do not follow previous behaviour because Scrawl-canvas anchor objects save the values for each under a different attribute key, compared to the DOM element’s attribute key:</p>

            </div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <ul>
<li>anchor.description -&gt; a.textContent - this is the text between the &lt;a&gt; element’s opening and closing tags</li>
<li>anchor.clickAction -&gt; a.onclick - a function that returns an string which is added to the DOM element’s ‘onclick’ attribute</li>
</ul>

            </div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>TODO - need to add in additional actions: <strong>focusAction</strong> (for ‘onfocus’ events) and <strong>blurAction</strong> (for ‘onblur’ events) - these will help capture/control keyboard mediated tabbing through a web page. The idea is that when an &lt;a&gt; element becomes focussed via keyboard tabbing (or other assistive technology methods) then we will be able to cascade the activity back into Scrawl-canvas so appropriate (visual) responses can be made to indicate the event has happened. </p>

            </div>
            
            <div class="content"><div class='highlight'><pre>S.description = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{

    <span class="hljs-keyword">this</span>.description = item;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) <span class="hljs-keyword">this</span>.domElement.textContent = item;
};

S.clickAction = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{

    <span class="hljs-keyword">if</span> (isa_fn(item)) {

        <span class="hljs-keyword">this</span>.clickAction = item;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) <span class="hljs-keyword">this</span>.domElement.setAttribute(<span class="hljs-string">'onclick'</span>, item());
    }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <h2 id="define-prototype-functions">Define prototype functions</h2>

            </div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>The <strong>build</strong> function builds the &lt;a&gt; element and adds it to the DOM</p>

            </div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>All Scrawl-canvas generated anchor links are kept in a hidden &lt;nav&gt; element (referenced by <em>scrawlNavigationHold</em>) which Scrawl-canvas automatically generates and adds to the top of the body element when it first runs. </p>

            </div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>This is done to give screen readers access to link URLs and descriptions associated with Canvas graphical entitys (which visually impaired users may not be able to see). It also allows links to be tabbed through and invoked in the normal way (which may vary dependent on how browsers implement tab focus functionality)</p>

            </div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>TODO: consider whether the top of the document is the best place to store hidden anchor elements. It may be better to store them in a nextChild element following the canvas/stack element where the artefact is being used?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.build = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) scrawlNavigationHold.removeChild(<span class="hljs-keyword">this</span>.domElement);

    <span class="hljs-keyword">let</span> link = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'a'</span>);

    link.id = <span class="hljs-keyword">this</span>.name;

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.download) link.setAttribute(<span class="hljs-string">'download'</span>, <span class="hljs-keyword">this</span>.download);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.href) link.setAttribute(<span class="hljs-string">'href'</span>, <span class="hljs-keyword">this</span>.href);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hreflang) link.setAttribute(<span class="hljs-string">'hreflang'</span>, <span class="hljs-keyword">this</span>.hreflang);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ping) link.setAttribute(<span class="hljs-string">'ping'</span>, <span class="hljs-keyword">this</span>.ping);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.referrerpolicy) link.setAttribute(<span class="hljs-string">'referrerpolicy'</span>, <span class="hljs-keyword">this</span>.referrerpolicy);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.rel) link.setAttribute(<span class="hljs-string">'rel'</span>, <span class="hljs-keyword">this</span>.rel);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.target) link.setAttribute(<span class="hljs-string">'target'</span>, <span class="hljs-keyword">this</span>.target);
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.anchorType) link.setAttribute(<span class="hljs-string">'type'</span>, <span class="hljs-keyword">this</span>.anchorType);

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.clickAction &amp;&amp; isa_fn(<span class="hljs-keyword">this</span>.clickAction)) link.setAttribute(<span class="hljs-string">'onclick'</span>, <span class="hljs-keyword">this</span>.clickAction());

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.description) link.textContent = <span class="hljs-keyword">this</span>.description;

    <span class="hljs-keyword">this</span>.domElement = link;

    scrawlNavigationHold.appendChild(link);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>Internal function - update the DOM element attribute</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.update = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) <span class="hljs-keyword">this</span>.domElement.setAttribute(item, <span class="hljs-keyword">this</span>[item]);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>To action a user click on an artifact with an associated anchor object, we generate a DOM MouseEvent originating from the anchor element which the browser can act on in the usual manner (browser/device dependent)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.click = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">let</span> e = <span class="hljs-keyword">new</span> MouseEvent(<span class="hljs-string">'click'</span>, {
        <span class="hljs-attr">view</span>: <span class="hljs-built_in">window</span>,
        <span class="hljs-attr">bubbles</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">cancelable</span>: <span class="hljs-literal">true</span>
    });

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.domElement.dispatchEvent(e);
};</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>TODO - documentation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>P.demolish = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.domElement) scrawlNavigationHold.removeChild(<span class="hljs-keyword">this</span>.domElement);

    <span class="hljs-keyword">this</span>.deregister();
};</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <h2 id="exported-factory-function">Exported factory function</h2>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> makeAnchor = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">items</span>) </span>{
    
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Anchor(items);
};

constructors.Anchor = Anchor;

<span class="hljs-keyword">export</span> {
    makeAnchor,
};</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
